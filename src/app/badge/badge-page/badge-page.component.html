<div class="container">

    <nav class="main-breadcrumb" aria-label="breadcrumb">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a [routerLink]="['/']">Home</a></li>
            <li class="breadcrumb-item"><a [routerLink]="['/', serverGroup.key]">{{serverGroup.name}}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{badge | badgeName}}</li>
        </ol>
    </nav>

    <div class="row">
        <div class="order-1 col-12  order-md-0 col-md-8">
            <h2 class="d-none d-md-block">
                <badge-name-inline [badge]="badge"></badge-name-inline>
            </h2>
            <hr>

            <p>
                <badge-text [badge]="badge"></badge-text>
            </p>

            <p *ngIf="badge.acquisition" class="acquisition">{{badge.acquisition}}</p>

            <ng-container *ngIf="badge.effect">
                <h3>Effect</h3>
                <hr>
                <p class="effect" [innerHTML]="badge.effect"></p>
            </ng-container>

            <ng-container *ngIf="badge.notes">
                <h3>Notes</h3>
                <hr>
                <p class="notes markdown" [innerHTML]="badge.notes | markdown | smartLinks:{serverGroup: serverGroup}"></p>
            </ng-container>


            <!-- Partials -->
            <ng-container *ngIf="badge.partials">
                <h3>Requirements</h3>
                <hr>
                <table class="partials-list table table-striped table-bordered table-responsive">
                    <tbody>
                    <tr *ngFor="let partial of badge.partials">

                        <!-- BADGES -->
                        <ng-container *ngVar="partial.badgeKey | badge:serverGroup as referencedBadge">
                            <td class="badge-icon">
                                <a *ngIf="referencedBadge != null" [routerLink]="['/', referencedBadge.serverGroup.key, 'badge', referencedBadge.key]">
                                    <badge-icons [badge]="referencedBadge"></badge-icons>
                                </a>
                            </td>

                            <td class="badge-name">
                                <a *ngIf="referencedBadge != null; else missingBadge" [routerLink]="['/', referencedBadge.serverGroup.key, 'badge', referencedBadge.key]">
                                    <badge-name-stacked [badge]="referencedBadge"></badge-name-stacked>
                                </a>
                                <ng-template #missingBadge>
                                    <div class="bad-link">{{partial.badgeKey}}</div>
                                </ng-template>
                            </td>

                            <td class="badge-type">
                                <a *ngIf="referencedBadge != null" class="badge-type" [routerLink]="['/', referencedBadge.serverGroup.key, 'badge', referencedBadge.key]">
                                    {{referencedBadge.type | badgeType}}
                                </a>
                            </td>

                            <td class="badge-description">
                                <a *ngIf="referencedBadge != null" class="badge-type" [routerLink]="['/', referencedBadge.serverGroup.key, 'badge', referencedBadge.key]">
                                    <badge-description [badge]="referencedBadge"></badge-description>
                                </a>
                            </td>
                        </ng-container>


                        <!-- PLAQUES-->
                        <td *ngIf="partial.type === 'PLAQUE'">
                            <badge-location [data]="partial"></badge-location>
                        </td>
                        <td *ngIf="partial.inscription" class="d-none d-md-table-cell">
                            <blockquote class="blockquote">
                                <footer class="blockquote-footer">{{partial.inscription}}</footer>
                            </blockquote>
                        </td>
                        <td *ngIf="partial.notes">{{partial.notes}}</td>

                        <!-- INVENTIONS -->
                        <td *ngIf="partial.type === 'INVENTION'">
                            Craft {{partial.count}} level {{partial.inventionLevel}}
                            <invention-types [inventionTypes]="partial.inventionTypes"></invention-types>
                            enhancement{{partial.count > 1 ? "s" : ""}}.
                        </td>
                        <td *ngIf="partial.type === 'INVENTION_PLUS_ONE'">Plus one more of either level.</td>
                    </tr>
                    </tbody>
                </table>
            </ng-container>

        </div>

        <div class="order-0 col-12 order-md-1 col-md-4">
            <table class="table table-striped table-bordered infobox">
                <tbody>
                <tr>
                    <td class="header">
                        <badge-name-stacked class="d-block d-md-none" [badge]="badge"></badge-name-stacked>
                        <badge-icons [badge]="badge"></badge-icons>
                    </td>
                </tr>
                <tr>
                    <td>
                        <dl>
                            <dt>Alignment</dt>
                            <dd>
                                <badge-alignment-stacked [badge]="badge"></badge-alignment-stacked>
                            </dd>

                            <dt *ngIf="badge.mapKey">Location</dt>
                            <dd *ngIf="badge.mapKey" class="location">
                                <badge-location [data]="badge"></badge-location>
                            </dd>

                            <dt *ngIf="badge.links">Links</dt>
                            <dd *ngIf="badge.links">
                                <links-stacked [links]="badge.links"></links-stacked>
                            </dd>
                        </dl>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>
